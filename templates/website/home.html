{% extends 'resume/base.html' %}
{% load static %}
{% block custom_css %}

{% endblock %}
{% block content %}
  <main class="mx-auto mt-2 flex flex-col lg:flex-row" style="width: 95%; bg-[#1]" >
    <aside class="hidden xl:block lg:w-1/32 mr-5 bg-white shadow p-4 rounded-lg mb-6 lg:mb-0 h-full">
    <form method="GET" action="{% url 'home' %}">
        <div class="mb-4">
            <div class="flex justify-between items-center">
                <h2 class="font-bold text-lg mb-2">Filter</h2>
                <button type="submit" class="pointer" style="color: #1e90ff;">Apply Filters</button>
            </div>
            <div class="mb-2">
                <label class="block text-gray-700">Salary: <span id="salaryValue">$3300</span></label>
                <input type="range" min="300" max="5000" value="3300" class="w-full mt-1" id="salaryRange" name="salary_range" oninput="updateSalaryValue(this.value)" />
                <div class="flex justify-between">
                    <p>$300</p>
                    <p>$5K</p>
                </div>
            </div>
            <div class="mb-2">
                <label class="block text-gray-700 font-bold">Job Type</label>
                <div>
                    <label class="block text-gray-600"><input type="checkbox" name="job_type" value="Urgent" class="mr-2" />Urgent</label>
                    <label class="block text-gray-600"><input type="checkbox" name="job_type" value="Remote" class="mr-2" />Remote</label>
                    <label class="block text-gray-600"><input type="checkbox" name="job_type" value="Full-Time" class="mr-2" />Full-Time</label>
                </div>
            </div>
            <div class="mb-2">
                <label class="block text-gray-700 font-bold">Experience Level</label>
                <div>
                    <div class="flex justify-between">
                        <label class="block text-gray-600"><input type="checkbox" name="experience_levels" value="Entry Level" class="mr-2" />Entry Level</label>
                        <p>325 jobs</p>
                    </div>
                    <div class="flex justify-between">
                        <label class="block text-gray-600"><input type="checkbox" name="experience_levels" value="Intermediate" class="mr-2" />Intermediate</label>
                        <p>523 jobs</p>
                    </div>
                    <div class="flex justify-between">
                        <label class="block text-gray-600"><input type="checkbox" name="experience_levels" value="Expert" class="mr-2" />Expert</label>
                        <p>200 Jobs</p>
                    </div>
                </div>
            </div>
            <div class="mb-2">
                <label class="block text-gray-700 font-bold">Job Location</label>
                <div>
                    <label class="block text-gray-600"><input type="checkbox" name="job_location" value="On Site" class="mr-2" />On Site</label>
                    <div class="relative">
                        <input type="text" name="location_query" placeholder="Search by location" class="border bg-gray-300 w-full py-1 px-3 text-gray-700 rounded-lg focus:outline-none focus:border-blue-500" />
                    </div>
                    <label class="block text-gray-600"><input type="checkbox" name="job_location" value="Remote" class="mr-2" />Remote</label>
                </div>
            </div>
            <div class="mb-2">
                <label class="block text-gray-700 font-bold">Applicants</label>
                <div>
                    <div class="flex justify-between">
                        <label class="block text-gray-600"><input type="checkbox" name="applicants" value="Less than 10" class="mr-2" />Less than 10</label>
                        <p>200 jobs</p>
                    </div>
                    <div class="flex justify-between">
                        <label class="block text-gray-600"><input type="checkbox" name="applicants" value="10 to 50" class="mr-2" />10 to 50</label>
                        <p>325 jobs</p>
                    </div>
                    <div class="flex justify-between">
                        <label class="block text-gray-600"><input type="checkbox" name="applicants" value="50 to 100" class="mr-2" />50 to 100</label>
                        <p>50 jobs</p>
                    </div>
                    <div class="flex justify-between">
                        <label class="block text-gray-600"><input type="checkbox" name="applicants" value="More than 100" class="mr-2" />More than 100</label>
                        <p>230 jobs</p>
                    </div>
                </div>
            </div>
        </div>
    </form>
</aside>
<div class="lg:flex-1 flex flex-col lg:flex-row justify-between">
      <div class="lg:w-3/4 lg:mr-5">
        <div class="p-8 rounded-lg shadow mb-4 text-white" style="background-color:#1e90ff;">
          <h2 class="text-xl font-bold mb-2">Find your dream job here!</h2>
          <p class="text-white mb-4">Explore the latest job openings and apply for the best job opportunities available today!</p>
          <div class="relative">
            <form method="get" action="{% url 'home' %}">
              <input type="text" name="search_query" placeholder="Search Job" class="border w-full py-2 px-3 text-gray-700 rounded-lg focus:outline-none focus:border-blue-500" />
              <button type="submit" class="absolute text-white px-8 py-1 m-1 rounded-xl" style="right: 1px; top: 0px; margin-top: 5px; background-color: #1e90ff;">Search</button>
            </form>
          </div>
        </div>
        <div class="">
          <div id="jobsContainer w-full">
            {% for job in jobs %}
              <div class="bg-white p-4 rounded-lg shadow mb-4">
                <div class="flex justify-between">
                  <div class="flex items-center">
                    <img src="{% static 'build/logo/logo-black.png' %}" class="rounded-fullw-12 h-12 object-cover" alt="img" srcset="" />
                    <div class=":flex flex-col">
                      <h3 class="text-lg font-bold ml-4">{{ job.title }}</h3>
                      <p class="ml-4">{{ job.company }}</p>
                    </div>
                    <p class="hidden lg:block p-2 bg-green-400 text-white rounded-xl ml-4" style="font-size: 10px;">Urgent</p>
                  </div>
                  <div class="text-black relative">
                    <i class="fa fa-ellipsis-v cursor-pointer job-options"></i>
                    <div class="dropdown-ellipse hidden absolute right-0 mt-2 w-28 bg-white border border-gray-300 rounded-md shadow-lg z-10">
                        <ul class="py-1">
                            <li onclick="viewJobDetails()" class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100 cursor-pointer">
                                <i class="fa fa-eye mr-2"></i> View 
                            </li>
                            <li onclick="shareJobPosting()" class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100 cursor-pointer">
                                <i class="fa fa-share mr-2"></i> Share
                            </li>
                            <li onclick="saveJobPosting()" class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100 cursor-pointer">
                                <i class="fa fa-bookmark mr-2"></i> Save
                            </li>
                            <li onclick="reportJobPosting()" class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100 cursor-pointer">
                                <i class="fa fa-flag mr-2"></i> Report
                            </li>
                        </ul>
                    </div>
                </div>
                </div>
                <div class="flex justify-between">
                  <div class="w-4/4 lg:flex justify-between items-center w-1/2">
                    <div>
                      <i class="fa fa-clock"></i>{{ job.job_type }}
                    </div>
                    <div>
                      <i class="fa fa-briefcase"></i> <span>{{ job.level }}</span>
                    </div>
                    <div>
                      <i class="fa fa-map-marker-alt"></i> <span>{{ job.location }}</span>
                    </div>
                  </div>
                  <p>{{ job.created_at }}</p>
                </div>
                <p class="w-9/10 mx-auto mt-4">{{ job.description|truncatewords:31 }}</p>
                <hr class="font-bold my-5" />
                <div class="flex justify-between">
                  <div class="w-full lg:w-1/2 flex justify-between items-center">
                    <div>
                      <i class="fa fa-dollar-sign"></i> <span class="mb-2 lg:font-semibold">${{ job.salary }}</span><span>/monthly</span>
                    </div>
                    {% with applications=job.application_set.all %}
                      <div>
                        <i class="fa fa-users"></i> <span class="font-semibold mr-2 md:mr-0">{{ applications|length }}</span><span class="ml-0 mr-5">Applied</span>
                      </div>
                    {% endwith %}
                  </div>
                  <a href="{% url 'job:job_details' job_id=job.id %}"><button type="button" class="p-1 px-3 rounded-lg xl:p-2 xl:px-6 text-white xl:rounded-xl" style="background-color: #1e90ff;">Apply</button></a>
                </div>
              </div>
            {% endfor %}
          </div>
        </div>
        <div class="pagination flex justify-center mt-6">
          <span class="step-links flex items-center space-x-2">
            {% if jobs.has_previous %}
              <a href="?page=1" class="px-3 py-1 border rounded-lg bg-gray-200 hover:bg-blue-200">&laquo; First</a>
              <a href="?page={{ jobs.previous_page_number }}" class="px-3 py-1 border rounded-lg bg-gray-200 hover:bg-blue-200">Previous</a>
            {% endif %}

            <span class="current px-3 py-1 border rounded-lg bg-white">Page {{ jobs.number }} of {{ jobs.paginator.num_pages }}</span>

            {% if jobs.has_next %}
              <a href="?page={{ jobs.next_page_number }}" class="px-3 py-1 border rounded-lg bg-gray-200 hover:bg-blue-200">Next</a>
              <a href="?page={{ jobs.paginator.num_pages }}" class="px-3 py-1 border rounded-lg bg-gray-200 hover:bg-blue-200">Last &raquo;</a>
            {% endif %}
          </span>
        </div>
      </div>
      <div class="w-full md:w-1/4 rounded-lg">
        <div class="mb-4 rounded-xl shadow bg-white p-3 py-2 flex justify-between items-center">
          <h2 class="font-bold text-lg">Suggested Jobs</h2>
          <i class="fas fa-exclamation-circle"></i>
        </div>
        <div class="carousel space-x-2 xl:space-y-4 flex md:block overflow-x-scroll">
         
          {% if matching_jobs %}
          {% for job, match_percentage in matching_jobs %}
              <a href="{% url 'job:job_details' job_id=job.id %}">
                <div class="bg-white p-3 rounded-lg min-w-[80%] md:min-w-full">
                  <div class="flex justify-between items-center cursor-pointer">
                    <div class="flex justify-between items-center">
                      <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDM2IDM2IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGFyaWEtbGFiZWw9IkdpdExhYiIgcm9sZT0iaW1nIj4KICA8dGl0bGU+R2l0TGFiPC90aXRsZT4KICA8cGF0aCBmaWxsPSIjRkM2RDI2IiBkPSJNMTggMzZsNi42OC0yMC42MDZIMTEuMzIyek0xOCAzNkwxMS4zMiAxNS4zOTRI Mi41MnpNMi41IDE1LjM5NGwtMS45NCA1Ljk4YTEuMjc1IDEuMjc1IDAgMDAuNDYgMS40MjBMMTggMzZ6TTIuNSAxNS4zOTRI MTEuMzJMNy43MiA0LjI0M2EuNjQuNjQgMCAwMC0xLjIxIDB6TTIgMzZsNi42OC0yMC42MDZIOC44TDYuN2QzLjYgNTAuNzg 0IDIxLjIzIDk5LjJ6TTI4TDFpLTM5NDUtNS4yNDEtNi40NzctMTAuMTE5YS42NC42NCAwIDExIDEuMjEgMHoiLz4KICA8cGF0aCBmaWxsPSIjRjI0MjI5IiBkPSJNMTggMzZMMTYuNjggMTUuMzk0aDguOHpNMzMuNDggMTUuMzk0bDEuOTQgNS45 OGEuM2MgMCAwMS0uNDYgMS40MjBMMTggMzZ6TTMzLjQ4IDE1LjM5NEgyNC42OGwzLjYgMTEuMTUxYS42NC42NCAwIDExIDEu MjEgMHoiLz4KICA8cGF0aCBmaWxsPSIjRjNDQkI5OSIgZD0iTTE4IDM2TDExLjMyIDE1LjM5NGgxMy4zNnciLz4KPC9zdmc+" class="rounded-full object-cover w-12 h-12" alt="{{ job.company }}-Logo" />
                      <h3 class="text-lg font-bold">{{ job.company }}</h3>
                    </div>
                    <i class="fa fa-ellipsis-v"></i>
                  </div>
                  <div class="mb-5">
                    <p class="text-gray-600 font-bold">{{ job.title }}</p>
                    <p class="text-gray-500 text-sm">{{ job.category }}</p>
                  </div>
                  <p class="text-gray-500 text-sm font-semibold">
                    {{ job.created_at|date:'Y-m-d' }} -{% with applications=job.application_set.all %}
                      <i class="fa fa-users"></i>
                      <span class="font-semibold mr-2 md:mr-0">{{ applications|length }}</span>
                      <span class="ml-0 mr-5">Applied</span>
                    {% endwith %}
                  </p>
   
                </div>
              </a>
            {% endfor %}
          {% elif not user.is_authenticated %}
              <div>
                <p class="text-center text-gray-500">You need to be logged in to see
                  suggested jobs</p>
                  <center><a href="{% url 'login' %}"><button type="button" class="p-1 px-3 rounded-lg xl:p-2 xl:px-6 text-white xl:rounded-xl" style="background-color: #1e90ff;">Login|SignUp</button></a></center>
                  </div>

              </div>
          {% else %}
            <p>No suggested jobs available.</p>
            <p>If havent't uploaded your resume, please click here <a style="color: #1e90ff;" href="{% url 'upload'%}">Upload</a> </p>
          {% endif %}
        </div>
      </div>
    </div>
  </main>
  <br />
{% endblock %}
