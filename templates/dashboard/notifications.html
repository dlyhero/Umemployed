 {% extends 'resume/base.html' %}
{% load static %}
 {% block custom_css %}
    
  {% endblock %}
{% block content %}

    <main
      class="container w-[98%] sm:w-[80%] mx-auto sm:mt-4 mb-2 p-4 bg-white rounded sm:shadow-md"
    >
      <h2 class="text-2xl font-bold mb-4">Notifications</h2>

      <!-- Summary Section -->
      <section class="mb-6">
        <div
          class="flex justify-between items-center bg-gray-100 p-4 rounded shadow-sm"
        >
          <div class="flex flex-col">
            <p class="text-lg font-medium">Total Notifications</p>
            <p class="text-2xl font-bold">10</p>
          </div>
          <div class="flex flex-col text-right">
            <p class="text-lg font-medium">Unread Notifications</p>
            <p class="text-2xl font-bold">3</p>
          </div>
        </div>
      </section>

      <!-- Notifications List -->
      <div id="notification-list">
        {% for notification in notifications %}
        <!-- Notification Items -->
        <div
          class="flex flex-col sm:flex-row justify-between items-start sm:items-center notification-item p-4 border-b cursor-pointer"
        >
          <div class="flex items-start sm:items-center">
            <div class="icon mr-4 mb-2 sm:mb-0">
          <!-- Map model notification types to correct icons -->
          {% if notification.notification_type == 'JOB_APPLICATION' %}
            <i class="fas fa-briefcase text-blue-600"></i> <!-- Job Application Icon -->
          {% elif notification.notification_type == 'NEW_JOB_POSTED' %}
            <i class="fas fa-clipboard-list text-green-600"></i> <!-- New Job Posted Icon -->
          {% elif notification.notification_type == 'ENDORSEMENT' %}
            <i class="fas fa-thumbs-up text-indigo-600"></i> <!-- Endorsement Icon -->
          {% elif notification.notification_type == 'INTERVIEW_SCHEDULED' %}
            <i class="fas fa-calendar-check text-purple-600"></i> <!-- Interview Scheduled Icon -->
          {% elif notification.notification_type == 'ACCOUNT_ALERT' %}
            <i class="fas fa-exclamation-triangle text-red-600"></i> <!-- Account Alert Icon -->
          {% elif notification.notification_type == 'UPCOMING_EVENT' %}
            <i class="fas fa-calendar-alt text-yellow-600"></i> <!-- Upcoming Event Icon -->
          {% elif notification.notification_type == 'NEW_MESSAGE' %}
            <i class="fas fa-envelope text-teal-600"></i> <!-- New Message Icon -->
          {% elif notification.notification_type == 'SPECIAL_OFFER' %}
            <i class="fas fa-gift text-orange-600"></i> <!-- Special Offer Icon -->
          {% elif notification.notification_type == 'PROFILE_UPDATED' %}
            <i class="fas fa-user-edit text-blue-600"></i> <!-- Profile Updated Icon -->
          {% else %}
            <i class="fas fa-bell text-gray-600"></i> <!-- Default Icon -->
          {% endif %}
        </div>
            <div class="notification-content">
              <p class="title text-lg font-semibold">
                {{ notification.title }}
              </p>
              <p class="message text-sm text-gray-600">
                {{ notification.message }}
              </p>
            </div>
          </div>
          <span class="time text-xs text-gray-500 mt-2 sm:mt-0"
            >{{ notification.timestamp|timesince }} ago</span
          >
        </div>
        {% endfor %}

        </div>

      <!-- Archived Notifications Section -->
      <section class="mt-6">
        <h3 class="text-xl font-semibold mb-2">Archived Notifications</h3>
        <div class="bg-gray-100 p-4 rounded shadow-sm">
          <p class="text-gray-600">
            You can review archived notifications here.
          </p>
          <!-- Example Archived Notification -->
          <div class="p-4 border-b">
            <p class="text-lg font-semibold">Archived Notification Example</p>
            <p class="text-sm text-gray-600">
              Details of the archived notification.
            </p>
            <span class="text-xs text-gray-500">Archived 1 month ago</span>
          </div>
        </div>
      </section>
    </main>
  </body>
  <script>
    const userId = {{ user.id }};
    const ws = new WebSocket(`ws://${window.location.host}/ws/notifications/`);

    ws.onmessage = function(e) {
        const data = JSON.parse(e.data);
        const notification = data.notification;
        // Update the UI with the new notification
        console.log('New notification:', notification);
        // You can append the notification to a list, show an alert, etc.
    };

    ws.onclose = function(e) {
        console.error('Chat socket closed unexpectedly');
    };

    // Handle sending messages if needed
</script>
  <script type="module" src="{% static 'build/scripts/addjob.js' %}"></script>
  <script src="{% static 'build/scripts/dashboard.js' %}"></script>
  <script src="{% static 'build/scripts/messages.js' %}"></script>
{% endblock %}
